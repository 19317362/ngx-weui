<span class="hljs-keyword">import</span> { Component, ViewEncapsulation, ViewChild } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;

<span class="hljs-keyword">import</span> { ChartG2Directive } <span class="hljs-keyword">from</span> <span class="hljs-string">'ngx-weui/chart-g2'</span>

<span class="hljs-meta">@Component</span>({
    selector: <span class="hljs-string">'example-chart-g2'</span>,
    templateUrl: <span class="hljs-string">'./chart-g2.component.html'</span>,
    styleUrls: [<span class="hljs-string">'./chart-g2.component.scss'</span>],
    encapsulation: ViewEncapsulation.None
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> DemoChartG2Component {
    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'c1'</span>) c1: ChartG2Directive;
    renderC1() {
        <span class="hljs-keyword">const</span> chart = <span class="hljs-keyword">this</span>.c1.chart;
        chart.source([
            { <span class="hljs-string">"tem"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"tokyo"</span> },
            { <span class="hljs-string">"tem"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"tem"</span>: <span class="hljs-number">3</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"berlin"</span> }
        ]);
        chart.interval().position(<span class="hljs-string">'city*tem'</span>).color(<span class="hljs-string">'city'</span>);
        chart.render();
    }

    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'c2'</span>) c2: ChartG2Directive;
    renderC2() {
        <span class="hljs-keyword">let</span> data = [
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周一'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周二'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">22</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周三'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周四'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周五'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周六'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周日'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">28</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"beijing"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周一'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周二'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">12</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周三'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周四'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周五'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">28</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周六'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> },
            { <span class="hljs-string">"time"</span>: <span class="hljs-string">'周日'</span>, <span class="hljs-string">"tem"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"city"</span>: <span class="hljs-string">"newYork"</span> }
        ];
        <span class="hljs-keyword">let</span> defs = {
            time: {
                tickCount: <span class="hljs-number">7</span>,
                range: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
            },
            tem: {
                tickCount: <span class="hljs-number">5</span>,
                min: <span class="hljs-number">0</span>
            }
        };
        <span class="hljs-comment">//配置time刻度文字样式</span>
        <span class="hljs-keyword">let</span> label = {
            fill: <span class="hljs-string">'#979797'</span>,
            font: <span class="hljs-string">'14px san-serif'</span>,
            offset: <span class="hljs-number">6</span>
        };

        <span class="hljs-keyword">let</span> Util = <span class="hljs-keyword">this</span>.c2.GM.Util;
        <span class="hljs-keyword">this</span>.c2.chart.axis(<span class="hljs-string">'time'</span>, {
            label: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">text, index, total</span>) </span>{
                <span class="hljs-keyword">var</span> cfg = Util.mix({}, label);
                <span class="hljs-comment">// 第一个点左对齐，最后一个点右对齐，其余居中，只有一个点时左对齐</span>
                <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) {
                    cfg.textAlign = <span class="hljs-string">'start'</span>;
                }
                <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">0</span> &amp;&amp; index === total - <span class="hljs-number">1</span>) {
                    cfg.textAlign = <span class="hljs-string">'end'</span>;
                }
                <span class="hljs-keyword">return</span> cfg;
            }
        });
        <span class="hljs-keyword">this</span>.c2.chart.axis(<span class="hljs-string">'tem'</span>, {
            label: {
                fontSize: <span class="hljs-number">14</span>
            }
        });
        <span class="hljs-keyword">this</span>.c2.chart.source(data, defs);
        <span class="hljs-keyword">this</span>.c2.chart.line().position(<span class="hljs-string">'time*tem'</span>).color(<span class="hljs-string">'city'</span>).shape(<span class="hljs-string">'smooth'</span>);
        <span class="hljs-keyword">this</span>.c2.chart.render();
    }

    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'c3'</span>) c3: ChartG2Directive;
    renderC3() {
        <span class="hljs-keyword">this</span>.c3.GM.Global.pixelRatio = <span class="hljs-number">2</span>;<span class="hljs-comment">//双精度</span>
        <span class="hljs-keyword">var</span> Shape = <span class="hljs-keyword">this</span>.c3.GM.Shape;
        <span class="hljs-keyword">var</span> G = <span class="hljs-keyword">this</span>.c3.GM.G;
        <span class="hljs-keyword">var</span> data = [{ pointer: <span class="hljs-string">'当前收益'</span>, value: <span class="hljs-number">5</span>, length: <span class="hljs-number">2</span>, y: <span class="hljs-number">1.05</span> }];
        <span class="hljs-comment">//自定义绘制数据的的形状      </span>
        Shape.registShape(<span class="hljs-string">'point'</span>, <span class="hljs-string">'dashBoard'</span>, {
            getShapePoints: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cfg</span>) </span>{
                <span class="hljs-keyword">var</span> x = cfg.x;
                <span class="hljs-keyword">var</span> y = cfg.y;
                <span class="hljs-keyword">return</span> [
                    { x: x, y: y },
                    { x: x, y: <span class="hljs-number">0.5</span> }
                ]
            },
            drawShape: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cfg, canvas</span>) </span>{
                <span class="hljs-keyword">var</span> point1 = cfg.points[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">var</span> point2 = cfg.points[<span class="hljs-number">1</span>];
                point1 = <span class="hljs-keyword">this</span>.parsePoint(point1);
                point2 = <span class="hljs-keyword">this</span>.parsePoint(point2);
                G.drawLines([point1, point2], canvas, {
                    stroke: <span class="hljs-string">'#18b7d6'</span>,
                    lineWidth: <span class="hljs-number">2</span>
                });
                <span class="hljs-keyword">var</span> text = cfg.origin._origin.value.toString();
                G.drawText(text + <span class="hljs-string">'%'</span>, cfg.center, canvas, {
                    fillStyle: <span class="hljs-string">'#f75b5b'</span>,
                    font: <span class="hljs-string">'30px Arial'</span>,
                    textAlign: <span class="hljs-string">'center'</span>,
                    textBaseline: <span class="hljs-string">'bottom'</span>
                });
                G.drawText(cfg.origin._origin.pointer, cfg.center, canvas, {
                    fillStyle: <span class="hljs-string">'#ccc'</span>,
                    textAlign: <span class="hljs-string">'center'</span>,
                    textBaseline: <span class="hljs-string">'top'</span>
                });
            }
        });
        <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.c3.chart;
        chart.source(data, {
            <span class="hljs-string">'value'</span>: { <span class="hljs-keyword">type</span>: <span class="hljs-string">'linear'</span>, min: <span class="hljs-number">0</span>, max: <span class="hljs-number">15</span>, tickCount: <span class="hljs-number">6</span> },
            <span class="hljs-string">'length'</span>: { <span class="hljs-keyword">type</span>: <span class="hljs-string">'linear'</span>, min: <span class="hljs-number">0</span>, max: <span class="hljs-number">10</span> },
            y: { <span class="hljs-keyword">type</span>: <span class="hljs-string">'linear'</span>, min: <span class="hljs-number">0</span>, max: <span class="hljs-number">1</span> }
        });
        chart.coord(<span class="hljs-string">'polar'</span>, {
            inner: <span class="hljs-number">0</span>,
            startAngle: <span class="hljs-number">-1.25</span> * <span class="hljs-built_in">Math</span>.PI,
            endAngle: <span class="hljs-number">0.25</span> * <span class="hljs-built_in">Math</span>.PI
        });
        <span class="hljs-comment">//配置value轴刻度线</span>
        chart.axis(<span class="hljs-string">'value'</span>, {
            tickLine: {
                strokeStyle: <span class="hljs-string">'#b9e6ef'</span>,
                lineWidth: <span class="hljs-number">2</span>,
                value: <span class="hljs-number">-5</span>
            },
            label: <span class="hljs-literal">null</span>,
            grid: <span class="hljs-literal">null</span>,
            line: <span class="hljs-literal">null</span>
        });
        chart.axis(<span class="hljs-string">'y'</span>, <span class="hljs-literal">false</span>);
        <span class="hljs-comment">//绘制仪表盘辅助元素</span>
        chart.guide().arc([<span class="hljs-number">0</span>, <span class="hljs-number">1.05</span>], [<span class="hljs-number">4.8</span>, <span class="hljs-number">1.05</span>], {
            strokeStyle: <span class="hljs-string">'#18b7d6'</span>,
            lineWidth: <span class="hljs-number">5</span>,
            lineCap: <span class="hljs-string">'round'</span>
        });
        chart.guide().arc([<span class="hljs-number">5.2</span>, <span class="hljs-number">1.05</span>], [<span class="hljs-number">9.8</span>, <span class="hljs-number">1.05</span>], {
            strokeStyle: <span class="hljs-string">'#ccc'</span>,
            lineWidth: <span class="hljs-number">5</span>,
            lineCap: <span class="hljs-string">'round'</span>
        });
        chart.guide().arc([<span class="hljs-number">10.2</span>, <span class="hljs-number">1.05</span>], [<span class="hljs-number">15</span>, <span class="hljs-number">1.05</span>], {
            strokeStyle: <span class="hljs-string">'#ccc'</span>,
            lineWidth: <span class="hljs-number">5</span>,
            lineCap: <span class="hljs-string">'round'</span>
        });
        chart.guide().arc([<span class="hljs-number">0</span>, <span class="hljs-number">1.2</span>], [<span class="hljs-number">15</span>, <span class="hljs-number">1.2</span>], {
            strokeStyle: <span class="hljs-string">'#ccc'</span>,
            lineWidth: <span class="hljs-number">1</span>
        });
        chart.guide().text([<span class="hljs-number">-0.5</span>, <span class="hljs-number">1.3</span>], <span class="hljs-string">'0.00%'</span>, {
            fillStyle: <span class="hljs-string">'#ccc'</span>,
            font: <span class="hljs-string">'18px Arial'</span>,
            textAlign: <span class="hljs-string">'center'</span>
        });
        chart.guide().text([<span class="hljs-number">7.5</span>, <span class="hljs-number">0.7</span>], <span class="hljs-string">'7.50%'</span>, {
            fillStyle: <span class="hljs-string">'#ccc'</span>,
            font: <span class="hljs-string">'18px Arial'</span>,
            textAlign: <span class="hljs-string">'center'</span>
        });
        chart.guide().text([<span class="hljs-number">15.5</span>, <span class="hljs-number">1.3</span>], <span class="hljs-string">'15.00%'</span>, {
            fillStyle: <span class="hljs-string">'#ccc'</span>,
            font: <span class="hljs-string">'18px Arial'</span>,
            textAlign: <span class="hljs-string">'center'</span>
        });
        chart.point().position(<span class="hljs-string">'value*y'</span>).size(<span class="hljs-string">'length'</span>).color(<span class="hljs-string">'#18b7d6'</span>).shape(<span class="hljs-string">'dashBoard'</span>);
        chart.render();
    }

    ngAfterViewInit() {
        <span class="hljs-keyword">this</span>.renderC1();
        <span class="hljs-keyword">this</span>.renderC2();
        <span class="hljs-keyword">this</span>.renderC3();
    }
}
