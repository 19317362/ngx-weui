<span class="hljs-keyword">import</span> { Component, ViewEncapsulation, ViewChild } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { Observable } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/Rx'</span>;

<span class="hljs-keyword">import</span> { SkinType, InputType } <span class="hljs-keyword">from</span> <span class="hljs-string">'ngx-weui'</span>;
<span class="hljs-keyword">import</span> { DialogService, DialogConfig, DialogComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">"ngx-weui/dialog"</span>;
<span class="hljs-keyword">import</span> { ToastService } <span class="hljs-keyword">from</span> <span class="hljs-string">"ngx-weui/toast"</span>;

<span class="hljs-meta">@Component</span>({
    selector: <span class="hljs-string">'example-dialog'</span>,
    templateUrl: <span class="hljs-string">'./dialog.component.html'</span>,
    styleUrls: [<span class="hljs-string">'./dialog.component.scss'</span>],
    encapsulation: ViewEncapsulation.None
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> DemoDialogComponent {

    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'ios'</span>) iosAS: DialogComponent;
    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'android'</span>) androidAS: DialogComponent;
    <span class="hljs-meta">@ViewChild</span>(<span class="hljs-string">'auto'</span>) autoAS: DialogComponent;

    <span class="hljs-keyword">private</span> DEFCONFIG: DialogConfig = &lt;DialogConfig&gt;{
        title: <span class="hljs-string">'弹窗标题'</span>,
        content: <span class="hljs-string">'弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内'</span>,
        cancel: <span class="hljs-string">'辅助操作'</span>,
        confirm: <span class="hljs-string">'主操作'</span>,
        inputPlaceholder: <span class="hljs-string">'必填项'</span>,
        inputError: <span class="hljs-string">'请填写或选择项'</span>,
        inputRequired: <span class="hljs-literal">true</span>,
        inputAttributes: {
            maxlength: <span class="hljs-number">140</span>,
            cn: <span class="hljs-number">2</span>
        },
        inputOptions: [
            { text: <span class="hljs-string">'请选择'</span> },
            { text: <span class="hljs-string">'杜蕾斯'</span>, value: <span class="hljs-string">'durex'</span>, other: <span class="hljs-number">1</span> },
            { text: <span class="hljs-string">'杰士邦'</span>, value: <span class="hljs-string">'jissbon'</span> },
            { text: <span class="hljs-string">'多乐士'</span>, value: <span class="hljs-string">'donless'</span> },
            { text: <span class="hljs-string">'处男'</span>, value: <span class="hljs-string">'first'</span> }
        ]
    };
    config: DialogConfig = {};

    <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> srv: DialogService, <span class="hljs-keyword">private</span> toastService: ToastService</span>) {
    }

    onShow(<span class="hljs-keyword">type</span>: SkinType, style: <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span>) {
        <span class="hljs-keyword">this</span>.config = <span class="hljs-built_in">Object</span>.assign({}, <span class="hljs-keyword">this</span>.DEFCONFIG, &lt;DialogConfig&gt;{
            skin: <span class="hljs-keyword">type</span>,
            cancel: <span class="hljs-literal">null</span>,
            confirm: <span class="hljs-literal">null</span>,
            btns: <span class="hljs-literal">null</span>,
            content: <span class="hljs-string">'弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内'</span>
        });
        <span class="hljs-keyword">switch</span> (style) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                <span class="hljs-keyword">this</span>.config.cancel = <span class="hljs-string">'辅助操作'</span>;
                <span class="hljs-keyword">this</span>.config.confirm = <span class="hljs-string">'主操作'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
                <span class="hljs-keyword">this</span>.config.confirm = <span class="hljs-string">'主操作'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
                <span class="hljs-keyword">this</span>.config.btns = [
                    { text: <span class="hljs-string">'否'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'default'</span>, value: <span class="hljs-number">1</span> },
                    { text: <span class="hljs-string">'不确定'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'default'</span>, value: <span class="hljs-number">2</span> },
                    { text: <span class="hljs-string">'是'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'primary'</span>, value: <span class="hljs-number">3</span> }
                ];
                <span class="hljs-keyword">break</span>;
        }
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-function">(<span class="hljs-params">&lt;DialogComponent&gt;<span class="hljs-keyword">this</span>[`${<span class="hljs-keyword">type</span>}AS`]</span>).<span class="hljs-params">show</span><span class="hljs-params">()</span>.<span class="hljs-params">subscribe</span>(<span class="hljs-params">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt; {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-params">'<span class="hljs-keyword">type</span>', res</span>);
            }</span>);
        }, 10);
        <span class="hljs-params">return</span> <span class="hljs-params">false</span>;
    }

    <span class="hljs-params">onShowBySrv</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: SkinType, backdrop: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span></span>) {
        <span class="hljs-params">this</span>.<span class="hljs-params">config</span> = <span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{}, <span class="hljs-keyword">this</span>.DEFCONFIG, &lt;DialogConfig&gt;{
            skin: <span class="hljs-keyword">type</span>,
            backdrop: backdrop,
            content: '弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内'
        }</span>);
        <span class="hljs-params">this</span>.<span class="hljs-params">srv</span>.<span class="hljs-params">show</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.config</span>).<span class="hljs-params">subscribe</span>(<span class="hljs-params">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-params">res</span>);
        }</span>);
        <span class="hljs-params">return</span> <span class="hljs-params">false</span>;
    }

    <span class="hljs-params">onShowOfHtml</span><span class="hljs-params">()</span> {
        <span class="hljs-params">this</span>.<span class="hljs-params">config</span> = <span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{}, <span class="hljs-keyword">this</span>.DEFCONFIG, &lt;DialogConfig&gt;{
            content: `
                &lt;p&gt;这是一段HTML&lt;strong&gt;加粗&lt;/strong&gt;&lt;/p&gt;
                &lt;p&gt;这是一段HTML&lt;strong&gt;加粗&lt;/strong&gt;&lt;/p&gt;
            `
        }</span>);
        <span class="hljs-params">this</span>.<span class="hljs-params">srv</span>.<span class="hljs-params">show</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.config</span>).<span class="hljs-params">subscribe</span>(<span class="hljs-params">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-params">res</span>);
        }</span>);
        <span class="hljs-params">return</span> <span class="hljs-params">false</span>;
    }

    <span class="hljs-params">promptValue</span>: <span class="hljs-params">any</span>;
    <span class="hljs-params">promptTypes</span>: <span class="hljs-params">string</span>[] = ['<span class="hljs-params">text</span>', '<span class="hljs-params">email</span>', '<span class="hljs-params">url</span>', '<span class="hljs-params">range</span>', '<span class="hljs-params">textarea</span>', '<span class="hljs-params">select</span>', '<span class="hljs-params">radio</span>', '<span class="hljs-params">checkbox</span>'];
    <span class="hljs-params">onShowPrompt</span>(<span class="hljs-params">inputType: InputType, useSrv: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span></span>) {
        <span class="hljs-params">this</span>.<span class="hljs-params">config</span> = <span class="hljs-params">Object</span>.<span class="hljs-params">assign</span>(<span class="hljs-params">{}, <span class="hljs-keyword">this</span>.DEFCONFIG, &lt;DialogConfig&gt;{
            skin: 'auto',
            <span class="hljs-keyword">type</span>: 'prompt',
            confirm: '确认',
            cancel: '取消',
            input: inputType,
            inputValue: <span class="hljs-literal">undefined</span>,
            inputRegex: <span class="hljs-literal">null</span>
        }</span>);
        <span class="hljs-params">if</span> (<span class="hljs-params">inputType === 'range'</span>) {
            <span class="hljs-params">this</span>.<span class="hljs-params">config</span>.<span class="hljs-params">inputValue</span> = 10;
        }
        <span class="hljs-params">if</span> (<span class="hljs-params">inputType === 'select'</span>) {
            <span class="hljs-params">this</span>.<span class="hljs-params">config</span>.<span class="hljs-params">inputValue</span> = <span class="hljs-params">this</span>.<span class="hljs-params">config</span>.<span class="hljs-params">inputOptions</span>[0];
        }
        <span class="hljs-params">if</span> (<span class="hljs-params">inputType === 'checkbox'</span>) {
            <span class="hljs-params">this</span>.<span class="hljs-params">config</span>.<span class="hljs-params">inputValue</span> = <span class="hljs-params">this</span>.<span class="hljs-params">config</span>.<span class="hljs-params">inputOptions</span>.<span class="hljs-params">slice</span>(<span class="hljs-params">1, 3</span>);
        }
        <span class="hljs-params">if</span> (<span class="hljs-params">useSrv</span>) {
            <span class="hljs-params">this</span>.<span class="hljs-params">srv</span>.<span class="hljs-params">show</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>.config</span>).<span class="hljs-params">subscribe</span>(<span class="hljs-params">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt; {
                <span class="hljs-keyword">if</span> (<span class="hljs-params">res.result</span>)
                    <span class="hljs-keyword">this</span>.toastService.show(<span class="hljs-params">`结果：${<span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-params">res.result</span>)}`</span>);
                <span class="hljs-built_in">console</span>.log(<span class="hljs-params">'prompt <span class="hljs-keyword">from</span> service', res</span>);
            }</span>);
        } <span class="hljs-params">else</span> {
            <span class="hljs-params">this</span>.<span class="hljs-params">autoAS</span>.<span class="hljs-params">show</span><span class="hljs-params">()</span>.<span class="hljs-params">subscribe</span>(<span class="hljs-params">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt; {
                <span class="hljs-keyword">if</span> (<span class="hljs-params">res.result</span>) {
                    <span class="hljs-keyword">this</span>.toastService.show(<span class="hljs-params">`结果：${<span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-params">res.result</span>)}`</span>);
                }
                <span class="hljs-built_in">console</span>.log(<span class="hljs-params">'prompt <span class="hljs-keyword">from</span> component', res</span>);
            }</span>);
        }
        <span class="hljs-params">return</span> <span class="hljs-params">false</span>;
    }

    <span class="hljs-params">ngOnDestroy</span><span class="hljs-params">()</span> {
        <span class="hljs-params">this</span>.<span class="hljs-params">srv</span>.<span class="hljs-params">destroyAll</span><span class="hljs-params">()</span>;
    }

}
</span>